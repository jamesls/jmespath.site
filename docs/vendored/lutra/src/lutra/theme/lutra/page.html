{% extends "!basic-ng/page.html" %}

<!-- Allow injecting a custom "hero" section. -->
{% block container %}
{%- if meta and meta["hero"] -%}
  {% if theme_hero %}
    {% include "partials/hero.html" with context %}
  {% else %}
    {{ warning("Found 'hero' in page metadata, but no hero attributes in conf.py") }}
  {%- endif -%}
{%- endif -%}

{{ super() }}
{% endblock container %}


<!-- Hide article header, if we're on the home page. -->
{% block content %}
<div class="sb-article-container">
  {%- if pagename != "index" -%}
  <header class="sb-header-article">
    {% include "sections/header-article.html" %}
  </header>
  {%- endif -%}
  <article class="sb-article" role="main">
    {% include "sections/article.html" %}
  </article>
  <footer class="sb-footer-article">
    {% include "sections/footer-article.html" %}
  </footer>
</div>
{% endblock content %}

<!-- Hide primary sidebar on full-width and page layouts. -->
{% block sidebar_primary %}
  {%- if not (meta and meta["layout"] == "page") -%}
    {{ super() }}
  {%- endif -%}
{% endblock %}

{% block body %}
<script>
  // Eager dark-mode handling.
  const currentTheme = localStorage.getItem("theme") || "auto";
  const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;

  document.body.dataset.theme = currentTheme;
  if ((currentTheme === "auto" && prefersDark) || currentTheme === "dark") {
    document.documentElement.classList.add("dark");
  }
  // Eager sidebar collapse
  if ((localStorage.getItem("collapsed") || "false") === "true") {
    document.body.classList.add("collapsed-site-navigation");
  }
</script>
<a class="skip-to-content" href="#lutra-main-content">
  {%- trans -%}
  Skip to content
  {%- endtrans -%}
</a>
{% include "partials/icons.html" %}
{{ super() }}
<script>
  // Setup handlers for jpexample processing.
  const jpExamples = document.querySelectorAll(".jpexample");

  jpExamples.forEach(jpExample => {
    const inputElement = jpExample.querySelector(".jpinput");
    inputElement.addEventListener("input", function() {
      const expression = this.value;
      const inputDoc = JSON.parse(jpExample.querySelector(".jpdoc").value);
      const result = jmespath.search(inputDoc, expression);
      jpExample.querySelector(".jpresult").value = JSON.stringify(result, null, 2);
    });
    // Trigger the event once when the page loads so we can populate the
    // initial the initial `.jpresult` values.
    const event = new Event("input");
    inputElement.dispatchEvent(event);
  });
</script>
{% endblock body %}

{% block footer %}
<footer class="sb-footer">
  <div class="sb-footer__inner sb-page-width">
    {% include "sections/footer.html" %}
  </div>
</footer>
{% endblock footer %}
